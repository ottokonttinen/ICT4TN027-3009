# h3 The Box

#### x) Katso ja tiivistä (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva.)<br> • Yksi valitsemasi IppSec:n murtautumisvideo.

Katsoin videon yhdein uusimmasta [videoista](https://www.youtube.com/watch?v=KcYBV1L2w_s&ab_channel=IppSec), video käsittelee HTTP Host header -hyökkäystä, joka liittyy salasanan palauttamiseen. Videolla IppSec esittelee tietoturva-aukon, joka mahdollistaa hyökkääjän nollaavan käyttäjän salasanan verkkosovelluksessa hyödyntämällä Host headerin injektiota.

Host header attack tarkoittaa hyökkäystä, jossa hyökkääjä manipuloi HTTP-pyynnön otsikkotietoa, joka sisältää HTTP-pyynnön kohteen palvelimen nimen (Host header). Hyökkääjä voi manipuloida pyyntöjä niin, että ne näyttävät olevan peräisin eri lähteistä tai kohtelevat eri palvelimia kuin todellisuudessa.

Hyökkääjä voi käyttää selaimen laajennusta salasanan palautusviestin laukaisemiseen ja sitten muokata HTTP Host -otsikkotietoa uudelleenohjatakseen salasanan palautuslinkin eri verkkosivulle.

Jotkut sähköpostisuodattimet voivat automaattisesti napsauttaa sähköpostien linkkejä, mikä tarkoittaa, että käyttäjän vuorovaikutusta ei aina tarvita hyökkäyksen onnistumiseksi. Esittelijä demonstroi hyökkäystä lähettämällä salasanan palautusviestin henkilökohtaiseen sähköpostiinsa ja osoittaen, että linkkiä napsautti botti, mikä osoitti hyökkäyksen onnistumisen.


#### a) We like to shop. Ratkaise Portswigger Academyn ["Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"](https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data). (Tee tarvittaessa tunnus Portswigger Academyyn).

Rekisteröiden portswiggerin sivulle, jotta pääsen suorittamaan tehtävää.

Laboratorioharjoitus sisältää SQL-injektion haavoittuvuuden verkkokaupan tuotekategorian suodattimessa. Kun käyttäjä valitsee kategorian, sovellus suorittaa SQL-kyselyn seuraavasti:  
```SQL
SELECT * FROM products WHERE category = 'Gifts' AND released = 1
```
Ratkaisun saavuttamiseksi tarvitaan SQL-injektiohyökkäys, joka saa sovelluksen näyttämään kaikkien tuotteiden yksityiskohdat missä tahansa kategoriassa.

Käynnistin harjoituksen nettivisun Kali-virtuaalikoneen selamisessa. Ajattelin ensiksi käyttää ZAP-välimiesproxya kaapatakseni liikennettä sivustolta ja etsiäkseni paikkaa mihin injektoika koodia. En kuitenkaan löytänyt aluksi mitään hakukenttää, johon olisi voinut syöttää mitään. Katsoin alun yhdestä [videosta](https://youtu.be/alTceRdSxS0), jossa selitetään ratkaisu. Sen jälkeen ymmärsin, että sivusto sisältää painikkeita, joilla voi suodattaa tuotekategorioita. Proxya ei siis tarvita ollenkaan, koska SQL-haut ovat painikkeiden linkkien URL-osoitteiden perässä. 
![Nimetön](https://user-images.githubusercontent.com/103586741/233626795-87c7676d-1661-4faf-9706-c824f426e6cb.png)
Kopioin yhden painikkeen linkin tekstieditoriin ja korvasin loppuosan tuotekategorian koodilla `'+OR+1=1--`. Tämä injektio pyrkii palauttamaan kaikki rivit tietokannasta, koska `+OR+1=1` on aina totta. Kommenttimerkki `--` muuttaa kaiken sen jälkeen tulevan komentiksi.
![kuva](https://user-images.githubusercontent.com/103586741/233627079-eb60aee1-e4c0-4802-9da2-94c6b860eab0.png)




#### b) HTB. Tee HackTheBox.com tunnus. Avaa OpenVPN-yhteys "Starting Point" verkkoon. Estä tunnelin ulkopuolinen liikenne eli liikenne oikeaan Internettiin (vinkit alla). Testaa, että normaali Internet-liikenteesi on estetty.

#### c) Meow. Käynnistä "Starting point": "Meow". (Spawn machine). Tallenna ruutukaappaus sivusta, jossa näkyy koneen osoite ja tunkeutumistehtäviä. Porttiskannaa kone ja analysoi tulokset. Suorita HTB:n antamat tehtävät. Raportoi normaalisti, "Starting point" -koneista saa julkaista läpikävelyohjeita.

#### d) Fawn. Ratkaise Fawn. (HTB Starting point)

#### e) Dancing. Ratkaise Dancing. (HTB Starting point)

#### f) Vapaaehtoinen tai vaihtoehtotehtävä kohdille b-e: korkkaa yksi normaali kone HackTheBoxin Machines-kohdasta.

#### g) Vapaaehtoinen: korkkaa toinenkin HTB Machines -kone.
